"use strict";(self.webpackChunknetlify_functions=self.webpackChunknetlify_functions||[]).push([[330],{2819:function(t,e,n){n.r(e);var a=n(7294),l=n(8767),o=n(6562),i=n(3974),r=n(2775),u=n(3218);function d(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}e.default=function(){var t,e,n,s,c,v,p,m,f=(0,a.useContext)(o.V).user,g=a.useState(!1),b=g[0],h=g[1],y=a.useState(""),Z=y[0],k=y[1],S=a.useState(!0),N=S[0],w=S[1],D=a.useState({bookingHeader:[],bookingData:[]}),H=D[0],j=D[1],O=a.useState({shoppingHeader:[],shoppingData:[]}),A=O[0],C=O[1],F=function(t){var e=[];if(t)for(var n=0;n<t.length;n++){var a;e.push(null==Object?void 0:Object.keys((null==t||null===(a=t[n])||void 0===a?void 0:a.data)||[]))}return e};a.useEffect((function(){f&&i.db.collection("users").doc((null==f?void 0:f.email)+"/").collection("bookings").orderBy("reservation","asc").onSnapshot((function(t){var e=t.docs.map((function(t){return{data:t.data()}}));if(e){for(var n,a=[],l=d(e);!(n=l()).done;){var o,i,r,u=n.value;a.push({appointment:null==u?void 0:u.data.appointment,category:null==u?void 0:u.data.category,personnel:null==u?void 0:u.data.personnel,reservation:(null===(o=new Date(1e3*(null==u||null===(i=u.data.reservation)||void 0===i?void 0:i.seconds)))||void 0===o?void 0:o.toDateString())+" at "+(null===(r=new Date(1e3*(null==u?void 0:u.data.reservation)))||void 0===r?void 0:r.toLocaleTimeString()),service:null==u?void 0:u.data.service,session:null==u?void 0:u.data.session})}j({bookingHeader:F(e),bookingData:a})}})),f&&i.db.collection("users").doc((null==f?void 0:f.email)+"/").collection("shoppings").orderBy("title","asc").onSnapshot((function(t){var e=t.docs.map((function(t){return{data:t.data()}}));if(e){for(var n,a=[],l=d(e);!(n=l()).done;){var o=n.value;a.push({address:null==o?void 0:o.data.address,customer:null==o?void 0:o.data.customer,description:null==o?void 0:o.data.description,id:null==o?void 0:o.data.id,price:"CA$ "+(null==o?void 0:o.data.price),quantity:null==o?void 0:o.data.quantity,title:null==o?void 0:o.data.title})}C({shoppingHeader:F(e),shoppingData:a})}}))}),[f]),N&&setTimeout((function(){w(!1)}),5e3);return(0,u.tZ)("div",null,(0,u.tZ)(l.Z,null,(0,u.tZ)("main",{className:"history-page"},0===(null==H?void 0:H.bookingHeader.length)&&0===(null==A?void 0:A.shoppingHeader.length)?N?(0,u.tZ)("span",null,"Loading..."):(0,u.tZ)("span",null,"Data not Found"):(0,u.tZ)(a.Fragment,null,(0,u.tZ)("div",{className:"top"},0!==(null==H?void 0:H.bookingHeader.length)&&(0,u.tZ)("p",{className:"account-page-header"},"Bookings"),(0,u.tZ)("table",null,(0,u.tZ)("thead",null,(0,u.tZ)("tr",{className:"table-head-row"},null==H||null===(t=H.bookingHeader)||void 0===t||null===(e=t[0])||void 0===e||null===(n=e.sort())||void 0===n?void 0:n.map((function(t,e){return(0,u.tZ)("th",{key:e,className:"table-head-item"},t," ","appointment"===t||"reservation"===t?" - date":"")})))),(0,u.tZ)("tbody",null,null==H||null===(s=H.bookingData)||void 0===s?void 0:s.map((function(t,e){var n;return(0,u.tZ)("tr",{className:"table-item-row",key:e},null==Object||null===(n=Object.values(t))||void 0===n?void 0:n.map((function(t,e){return(0,u.tZ)("td",{className:"table-items",key:e},t)})))}))))),(0,u.tZ)("div",{className:"bottom"},0!==(null==A?void 0:A.shoppingHeader.length)&&(0,u.tZ)("p",{className:"account-page-header"},"Shoppings"),(0,u.tZ)("table",null,(0,u.tZ)("thead",null,(0,u.tZ)("tr",{className:"table-head-row"},null==A||null===(c=A.shoppingHeader)||void 0===c||null===(v=c[0])||void 0===v||null===(p=v.sort())||void 0===p?void 0:p.map((function(t,e){return(0,u.tZ)("th",{key:e,className:"table-head-item"},t," ","appointment"===t||"reservation"===t?" - date":"")})))),(0,u.tZ)("tbody",null,null==A||null===(m=A.shoppingData)||void 0===m?void 0:m.map((function(t,e){var n;return(0,u.tZ)("tr",{className:"table-item-row",key:e},null==Object||null===(n=Object.values(t))||void 0===n?void 0:n.map((function(t,n){return(0,u.tZ)("td",{className:t.length>=200?"table-items align-left":"table-items",key:n},"string"==typeof t&&t.length>=200?b&&Z===e?t:t.substring(0,70)+"...":t,t.length>=200&&(0,u.tZ)(a.Fragment,null,(0,u.tZ)("span",{onClick:function(){return function(t){k(t),h(!b)}(e)}},b&&Z===e?(0,u.tZ)(a.Fragment,null,(0,u.tZ)("span",null,"Read Less")," ",(0,u.tZ)(r.DJ5,null)):(0,u.tZ)(a.Fragment,null,(0,u.tZ)("span",null,"Read More")," ",(0,u.tZ)(r.x3N,null)))))})))})))))))))}}}]);
//# sourceMappingURL=component---src-pages-history-js-2cc2fd1f60fafbde3119.js.map