{"version":3,"file":"component---src-pages-history-js-2cc2fd1f60fafbde3119.js","mappings":"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","sources":["webpack://netlify-functions/./src/pages/history.js"],"sourcesContent":["import React, { useContext } from \"react\"\nimport Layout from \"../components/Layout\"\nimport { AuthContext } from \"../context/auth\"\nimport { db } from \"../../firebase\"\nimport { MdOutlineKeyboardArrowUp } from \"react-icons/md\"\nimport { MdOutlineKeyboardArrowDown } from \"react-icons/md\"\n\nconst History = () => {\n  const { user } = useContext(AuthContext)\n  const [readMore, setReadMore] = React.useState(false)\n  const [matchIdx, setMatchIdx] = React.useState(\"\")\n  const [isLoading, setIsLoading] = React.useState(true)\n  const [bookingInfo, setBookingInfo] = React.useState({\n    bookingHeader: [],\n    bookingData: [],\n  })\n  const [shoppingInfo, setShoppingInfo] = React.useState({\n    shoppingHeader: [],\n    shoppingData: [],\n  })\n\n  const getObjectHeader = object => {\n    let objectKeys = []\n    if (object) {\n      for (let i = 0; i < object.length; i++) {\n        objectKeys.push(Object?.keys(object?.[i]?.data || []))\n      }\n    }\n    return objectKeys\n  }\n\n  React.useEffect(() => {\n    // getting booking history\n    user &&\n      db\n        .collection(\"users\")\n        .doc(`${user?.email}/`)\n        .collection(\"bookings\")\n        .orderBy(\"reservation\", \"asc\")\n        .onSnapshot(snapshot => {\n          const results = snapshot.docs.map(doc => ({\n            data: doc.data(),\n          }))\n          if (results) {\n            let data = []\n            for (const result of results) {\n              data.push({\n                appointment: result?.data.appointment,\n                category: result?.data.category,\n                personnel: result?.data.personnel,\n                reservation:\n                  `${new Date(\n                    result?.data.reservation?.seconds * 1000\n                  )?.toDateString()}` +\n                  \" at \" +\n                  `${new Date(\n                    result?.data.reservation * 1000\n                  )?.toLocaleTimeString()}`,\n                service: result?.data.service,\n                session: result?.data.session,\n              })\n            }\n            setBookingInfo({\n              bookingHeader: getObjectHeader(results),\n              bookingData: data,\n            })\n          }\n        })\n    // getting shopping history\n    user &&\n      db\n        .collection(\"users\")\n        .doc(`${user?.email}/`)\n        .collection(\"shoppings\")\n        .orderBy(\"title\", \"asc\")\n        .onSnapshot(snapshot => {\n          const results = snapshot.docs.map(doc => ({\n            data: doc.data(),\n          }))\n          if (results) {\n            let data = []\n            for (const result of results) {\n              data.push({\n                address: result?.data.address,\n                customer: result?.data.customer,\n                description: result?.data.description,\n                id: result?.data.id,\n                price: `CA$ ${result?.data.price}`,\n                quantity: result?.data.quantity,\n                title: result?.data.title,\n              })\n            }\n            setShoppingInfo({\n              shoppingHeader: getObjectHeader(results),\n              shoppingData: data,\n            })\n          }\n        })\n  }, [user])\n\n  if (isLoading) {\n    setTimeout(() => {\n      setIsLoading(false)\n    }, 5000)\n  }\n\n  const toggleRead = idx => {\n    setMatchIdx(idx)\n    setReadMore(!readMore)\n  }\n\n  return (\n    <div>\n      <Layout>\n        <main className=\"history-page\">\n          {bookingInfo?.bookingHeader.length === 0 &&\n          shoppingInfo?.shoppingHeader.length === 0 ? (\n            isLoading ? (\n              <span>Loading...</span>\n            ) : (\n              <span>Data not Found</span>\n            )\n          ) : (\n            <>\n              <div className=\"top\">\n                {bookingInfo?.bookingHeader.length !== 0 && (\n                  <p className=\"account-page-header\">Bookings</p>\n                )}\n                <table>\n                  <thead>\n                    <tr className=\"table-head-row\">\n                      {bookingInfo?.bookingHeader?.[0]\n                        ?.sort()\n                        ?.map((head, idx) => (\n                          <th key={idx} className=\"table-head-item\">\n                            {head}{\" \"}\n                            {head === \"appointment\" || head === \"reservation\"\n                              ? \" - date\"\n                              : \"\"}\n                          </th>\n                        ))}\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {bookingInfo?.bookingData?.map((item, idx) => (\n                      <tr className=\"table-item-row\" key={idx}>\n                        {Object?.values(item)?.map((itm, index) => (\n                          <td className=\"table-items\" key={index}>\n                            {itm}\n                          </td>\n                        ))}\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              <div className=\"bottom\">\n                {shoppingInfo?.shoppingHeader.length !== 0 && (\n                  <p className=\"account-page-header\">Shoppings</p>\n                )}\n                <table>\n                  <thead>\n                    <tr className=\"table-head-row\">\n                      {shoppingInfo?.shoppingHeader?.[0]\n                        ?.sort()\n                        ?.map((head, idx) => (\n                          <th key={idx} className=\"table-head-item\">\n                            {head}{\" \"}\n                            {head === \"appointment\" || head === \"reservation\"\n                              ? \" - date\"\n                              : \"\"}\n                          </th>\n                        ))}\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {shoppingInfo?.shoppingData?.map((item, idx) => (\n                      <tr className=\"table-item-row\" key={idx}>\n                        {Object?.values(item)?.map((itm, index) => (\n                          <td\n                            className={\n                              itm.length >= 200\n                                ? \"table-items align-left\"\n                                : \"table-items\"\n                            }\n                            key={index}\n                          >\n                            {typeof itm === \"string\"\n                              ? itm.length >= 200\n                                ? readMore && matchIdx === idx\n                                  ? itm\n                                  : `${itm.substring(0, 70)}...`\n                                : itm\n                              : itm}\n                            {itm.length >= 200 && (\n                              <>\n                                <span onClick={() => toggleRead(idx)}>\n                                  {readMore && matchIdx === idx ? (\n                                    <>\n                                      <span>Read Less</span>{\" \"}\n                                      <MdOutlineKeyboardArrowUp />\n                                    </>\n                                  ) : (\n                                    <>\n                                      <span>Read More</span>{\" \"}\n                                      <MdOutlineKeyboardArrowDown />\n                                    </>\n                                  )}\n                                </span>\n                              </>\n                            )}\n                          </td>\n                        ))}\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </>\n          )}\n        </main>\n      </Layout>\n    </div>\n  )\n}\n\nexport default History\n"],"names":["user","useContext","AuthContext","React","readMore","setReadMore","matchIdx","setMatchIdx","isLoading","setIsLoading","bookingHeader","bookingData","bookingInfo","setBookingInfo","shoppingHeader","shoppingData","shoppingInfo","setShoppingInfo","getObjectHeader","object","objectKeys","i","length","push","Object","keys","data","db","doc","email","collection","orderBy","onSnapshot","snapshot","results","docs","map","result","appointment","category","personnel","reservation","Date","seconds","toDateString","toLocaleTimeString","service","session","address","customer","description","id","price","quantity","title","setTimeout","className","sort","head","idx","key","item","values","itm","index","substring","onClick","toggleRead"],"sourceRoot":""}